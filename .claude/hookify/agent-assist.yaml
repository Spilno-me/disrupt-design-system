# AGENT-FIRST Hookify Rules
# Ultra-minimal, references JSON only

name: "agent-assist"
description: "Agent-first: 3-line prompts that reference structured data"
enabled: true
type: "callback"

# =============================================================================
# EDIT COMPONENT
# =============================================================================

- trigger:
    tool: "Edit"
    filePattern: "src/components/.+\\.tsx$"
  check: |
    âš ï¸  EDIT COMPONENT â†’ Read: .claude/agent-context.json â†’ workflow.editComponent
    Breaking? (rename/remove props) â†’ STOP â†’ v3.0.0 only
    Safe? (optional prop/bugfix) â†’ MINOR/PATCH â†’ Proceed
    testId: Read .claude/testing-quick-ref.md â†’ ATOM | MOLECULE | PAGE strategy

# =============================================================================
# CREATE COMPONENT
# =============================================================================

- trigger:
    tool: "Write"
    filePattern: "src/components/.+\\.tsx$"
  check: |
    âœ¨ NEW COMPONENT â†’ Read: .claude/agent-context.json â†’ workflow.createComponent
    testId: ATOM (accept) | MOLECULE (auto-gen from props) | PAGE (hardcode)
    Must: Export from src/index.ts + types + Update CLAUDE.md
    This is MINOR bump

# =============================================================================
# EDIT EXPORTS
# =============================================================================

- trigger:
    tool: "Edit"
    filePattern: "src/index\\.ts$"
  check: |
    ðŸ“¦ EXPORTS â†’ Read: .claude/agent-context.json â†’ components.exports
    Missing HIGH: NotificationsPanel, QuickFilter, DropdownMenu, Tabs
    Export: Component + Types + Sub-components + Hooks

# =============================================================================
# BUMP VERSION
# =============================================================================

- trigger:
    tool: "Edit"
    filePattern: "package\\.json$"
  check: |
    ðŸ“Œ VERSION â†’ Read: .claude/agent-context.json â†’ versioning
    PATCH|MINOR|MAJOR â†’ Update CHANGELOG.md
    MAJOR = v3.0.0 only (not now!)

# =============================================================================
# USE RAW COLOR (BLOCK)
# =============================================================================

- trigger:
    tool: "Edit"
    filePattern: "\\.(tsx?|css)$"
  check: |
    ðŸŽ¨ TOKENS ONLY â†’ Read: .claude/agent-context.json â†’ tokens
    âŒ NO: #hex, rgb(), bg-blue-500
    âœ… YES: ALIAS.text.primary, bg-surface, text-primary

# =============================================================================
# RECORD FINDING (Minimal prompt)
# =============================================================================

- trigger:
    tool: "Edit"
    filePattern: "src/.+\\.(tsx?|css)$"
  check: |
    ðŸ’¡ >30min debug? â†’ Record finding
    Template: .claude/findings/TEMPLATE.md
    Update: .claude/findings/index.json
