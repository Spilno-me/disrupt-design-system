{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "version": "1.0.0",
  "lastUpdated": "2025-12-14",
  "description": "AGENT-FIRST: Single source of truth for AI agents working on DDS. Read this FIRST.",

  "meta": {
    "projectName": "Disrupt Design System (DDS)",
    "currentVersion": "2.3.1",
    "nextVersion": "2.4.0",
    "majorVersion": "3.0.0",
    "phase": "pre-v3-development",
    "philosophy": "OPINIONATED - Strong design vision, minimal variants, maximum consistency"
  },

  "criticalRules": {
    "git": {
      "noClaudeAttribution": true,
      "commitFormat": "feat:|fix:|chore:|refactor:|docs:",
      "hookifyEnabled": true
    },
    "storybook": {
      "rules": ["reflectReality", "noHardcodedOverrides", "compositionOnly"],
      "reference": ".claude/storybook-rules.md"
    },
    "shadows": {
      "rule": "Elevation = Importance + Interactivity",
      "scale": "sm < md < elevated < lg < xl",
      "lookup": {
        "sm": "data display (tags, badges)",
        "md": "standard (cards, buttons)",
        "elevated": "premium (KPIs, CTAs)",
        "lg": "overlays (modals, sheets)",
        "xl": "critical (alerts)"
      },
      "default": "md",
      "reference": ".claude/DESIGN-SYSTEM.md"
    },
    "versioning": {
      "policy": "NO_BREAKING_CHANGES_UNTIL_V3",
      "breakingChanges": [
        "Rename props",
        "Remove props",
        "Change prop types (non-compatible)",
        "Change required/optional status",
        "Change default values",
        "Remove exports"
      ],
      "safeChanges": [
        "Add new components",
        "Add optional props with defaults",
        "Add new variants",
        "Fix bugs (no API change)",
        "Add deprecation warnings (keep working)",
        "Internal refactoring (same API)"
      ],
      "versionBumps": {
        "patch": "Bug fixes only, no API change",
        "minor": "New features, backwards compatible",
        "major": "Breaking changes (v3.0.0 only!)"
      }
    },
    "tokens": {
      "forbidden": ["#hex", "rgb()", "bg-blue-500"],
      "required": ["ALIAS tokens", "Semantic Tailwind"],
      "colorFormat": "oklch",
      "afterEdit": "npm run generate-tokens",
      "reference": ".claude/DESIGN-SYSTEM.md"
    },
    "exports": {
      "twoLevelSystem": true,
      "mustExportFrom": ["src/components/*/index.ts", "src/index.ts"],
      "alsoExport": ["Types", "Sub-components", "Hooks"],
      "missingHighPriority": ["NotificationsPanel", "QuickFilter", "DropdownMenu", "Tabs"]
    }
  },

  "workflow": {
    "editTokens": ["Edit designTokens.ts", "Run npm run generate-tokens", "typecheck", "CHANGELOG if user-facing"],
    "editComponent": ["Breaking? → STOP → v3.0.0", "Safe? → Proceed", "Use tokens only", "typecheck", "CHANGELOG"],
    "createComponent": ["Radix UI for interactive", "ALIAS/semantic Tailwind", "testId (ATOM/MOLECULE)", "Export src/index.ts", "Story", "MINOR bump"],
    "stabilizeComponent": ["Read component-stabilization-plan.md", "Website=FROZEN", "App=CAREFUL", "Safe changes only"],
    "refactorComponent": ["API change? → v3.0.0", "Internal only? → Proceed"],
    "bumpVersion": ["PATCH=bugfix", "MINOR=feature", "MAJOR=v3.0.0 only", "Update CHANGELOG"]
  },

  "components": {
    "existingCheck": {
      "searchFirst": "src/components/ui/",
      "beforeBuilding": "ALWAYS check if component exists",
      "registry": ".claude/component-registry.json"
    },
    "stabilization": {
      "websiteComponents": {
        "status": "FROZEN",
        "location": "src/components/sections/, src/components/layout/Footer.tsx",
        "rule": "DO NOT TOUCH - Website is production-ready",
        "sharedDependencies": ["Button", "GridBlobCanvas", "Card"],
        "count": 32
      },
      "appComponents": {
        "status": "CAN_STABILIZE_CAREFULLY",
        "location": "src/components/partners/, src/components/leads/, src/components/provisioning/",
        "rule": "SAFE changes only (add optional props, fix bugs, improve internals)",
        "count": 40
      },
      "sharedPrimitives": {
        "status": "EXTREME_CARE",
        "location": "src/components/ui/",
        "rule": "ADD ONLY, NEVER CHANGE existing props/variants/defaults",
        "highRisk": ["Button", "GridBlobCanvas", "Input", "Dialog", "Card", "DataTable"],
        "count": 48
      },
      "planFile": ".claude/component-stabilization-plan.md"
    },
    "styling": {
      "preferTailwind": true,
      "staticStyles": "Use semantic Tailwind classes (bg-surface, text-primary)",
      "dynamicStyles": "Use ALIAS tokens (style={{ color: ALIAS.text.error }})",
      "shadows": "SHADOWS.sm|md|lg or shadow-sm|md|lg",
      "radius": "RADIUS.xs|sm|md|lg or rounded-xs|sm|md|lg"
    },
    "variants": {
      "philosophy": "OPINIONATED - Minimal variants",
      "limits": { "state": "≤5", "action": "≤5", "sizes": "≤3", "animations": "1" },
      "keep": "functional/semantic only",
      "remove": "aesthetic/redundant",
      "reference": ".claude/variant-reduction-strategy.md"
    },
    "testing": {
      "strategy": "ATOM (accept) | MOLECULE (auto-gen) | PAGE (hardcode)",
      "reference": ".claude/testing-quick-ref.md"
    },
    "storybook": {
      "requiredStories": ["Default", "AllStates", "1-2 usage examples"],
      "allStates": "MANDATORY: All variants/sizes/states in one story",
      "focus": "autoFocus for real focus ring (not fake CSS)",
      "reference": ".claude/storybook-rules.md"
    }
  },

  "quickLookup": {
    "isBreaking": {
      "renameProp": true,
      "removeProp": true,
      "changeType": true,
      "changeDefault": true,
      "removeExport": true
    },
    "isSafe": {
      "addOptionalProp": true,
      "addComponent": true,
      "fixBug": true,
      "addVariant": true,
      "deprecate": true
    }
  },

  "documentation": {
    "maintenance": {
      "rule": "Documentation must be maintained like code - updated on every relevant commit",
      "triggers": {
        "visualDesignChange": "Update DESIGN-SYSTEM.md + DesignTokens.mdx + CHANGELOG",
        "newComponent": "Update component-registry.json + CHANGELOG + create stories",
        "tokenChange": "Run npm run generate-tokens + update DESIGN-SYSTEM.md if new pattern",
        "breakingChange": "Update v3-breaking-changes.md (defer to v3.0.0)"
      },
      "hierarchy": {
        "level1": "agent-context.json (rules) + component-registry.json (lookup)",
        "level2": "DESIGN-SYSTEM.md (visual decisions) + storybook-rules.md (patterns)",
        "level3": "Individual docs for specific topics (testing, v3, etc.)"
      }
    },
    "consolidation": {
      "visualDesign": ".claude/DESIGN-SYSTEM.md",
      "storybookRules": ".claude/storybook-rules.md",
      "removed": ["color-format-rule.md (→ DESIGN-SYSTEM.md)", "storybook-composition-rules.md (→ storybook-rules.md)"]
    }
  },

  "files": {
    "designSystem": ".claude/DESIGN-SYSTEM.md",
    "componentRegistry": ".claude/component-registry.json",
    "stabilizationPlan": ".claude/component-stabilization-plan.md",
    "coreComponentsPlan": ".claude/core-components-stabilization.md",
    "testingQuickRef": ".claude/testing-quick-ref.md",
    "testingQA": "TESTING.md",
    "variantReduction": ".claude/variant-reduction-strategy.md",
    "storybookRules": ".claude/storybook-rules.md",
    "v3BreakingChanges": ".claude/v3-breaking-changes.md",
    "componentBuilder": ".claude/agents/component-builder.md",
    "claudeMd": "CLAUDE.md",
    "changelog": "CHANGELOG.md",
    "tokens": "src/constants/designTokens.ts"
  },

  "commands": {
    "typecheck": "npm run typecheck",
    "lint": "npm run lint",
    "build": "npm run build",
    "storybook": "npm run storybook",
    "generateTokens": "npm run generate-tokens"
  }
}
