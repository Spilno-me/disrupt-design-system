{/* @jsxRuntime automatic */}
{/* @jsxImportSource react */}
import { Meta } from '@storybook/addon-docs/blocks';
import {
  Shield,
  CheckCircle,
  XCircle,
  AlertTriangle,
  ArrowRight,
  ArrowDown,
  GitCommit,
  Package,
  FileCode,
  Palette,
  FileText,
  Bot,
  Layers,
  Eye,
  RefreshCw,
  Workflow,
  BookOpen,
} from 'lucide-react';
import {
  BrandHero,
  InfoBox,
  FeatureCard,
  SectionHeader,
  GuidelineCard,
  ABYSS,
  DEEP_CURRENT,
  DUSK_REEF,
  CORAL,
  HARBOR,
  SUNRISE,
  PRIMITIVES,
  SHADOWS,
  RADIUS,
  SPACING,
} from '../brand/BrandComponents';
import { ValidationPipeline } from '../brand/ValidationPipeline';
import { ValidatorGrid } from '../brand/ValidatorGrid';

<Meta title="Foundation/Validation Flow" />

<BrandHero
  title="Validation Flow"
  description="How DDS prevents drift, ensures consistency, and maintains quality through automated validation at every stage."
  gradient="teal"
  decorativeIcon={<Shield size={180} color={PRIMITIVES.white} strokeWidth={1} />}
/>

<InfoBox variant="tip">
  <strong>Zero drift architecture.</strong> Every commit runs through sync scripts and validators.
  If something drifts out of sync, the build fails before it reaches production.
</InfoBox>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>The Big Picture</h2>

<SectionHeader
  icon={<Workflow size={20} />}
  title="Pre-Commit Pipeline"
  description="What happens when you commit code to DDS."
/>

<div style={{ marginBottom: SPACING.px.section }}>
  <ValidationPipeline />
</div>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Sync Scripts (Stage 1)</h2>

<SectionHeader
  icon={<RefreshCw size={20} />}
  title="Auto-Generation from Sources of Truth"
  description="These scripts generate files from single sources of truth, preventing manual drift."
/>

<div style={{
  display: 'grid',
  gridTemplateColumns: 'repeat(2, 1fr)',
  gap: SPACING.px.comfortable,
  marginBottom: SPACING.px.section,
}}>
  {/* sync:prompts */}
  <div style={{
    background: PRIMITIVES.softLinen,
    borderRadius: RADIUS.lg,
    padding: SPACING.px.comfortable,
    border: `1px solid ${ABYSS[100]}`,
  }}>
    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
      <BookOpen size={20} color={DEEP_CURRENT[600]} />
      <span style={{ fontWeight: 600, color: ABYSS[700] }}>sync:prompts</span>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[500], marginBottom: '12px' }}>
      Source: <code>prompts.ts</code>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[600] }}>
      Generates:
      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px' }}>
        <li><code>.claude/prompt-library.md</code></li>
        <li><code>{`.claude/skills/*.md`}</code> (11 files)</li>
      </ul>
    </div>
  </div>

  {/* sync:colors */}
  <div style={{
    background: PRIMITIVES.softLinen,
    borderRadius: RADIUS.lg,
    padding: SPACING.px.comfortable,
    border: `1px solid ${ABYSS[100]}`,
  }}>
    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
      <Palette size={20} color={DEEP_CURRENT[600]} />
      <span style={{ fontWeight: 600, color: ABYSS[700] }}>sync:colors</span>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[500], marginBottom: '12px' }}>
      Source: <code>designTokens.ts</code>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[600] }}>
      Generates:
      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px' }}>
        <li><code>.claude/color-matrix.json</code></li>
        <li><code>.claude/contrast-matrix.json</code></li>
      </ul>
    </div>
  </div>

  {/* sync-docs */}
  <div style={{
    background: PRIMITIVES.softLinen,
    borderRadius: RADIUS.lg,
    padding: SPACING.px.comfortable,
    border: `1px solid ${ABYSS[100]}`,
  }}>
    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
      <FileText size={20} color={DEEP_CURRENT[600]} />
      <span style={{ fontWeight: 600, color: ABYSS[700] }}>sync-docs</span>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[500], marginBottom: '12px' }}>
      Source: <code>agent-context.json</code>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[600] }}>
      Generates:
      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px' }}>
        <li><code>.claude/component-status.md</code></li>
        <li>Various agent reference docs</li>
      </ul>
    </div>
  </div>

  {/* update-docs */}
  <div style={{
    background: PRIMITIVES.softLinen,
    borderRadius: RADIUS.lg,
    padding: SPACING.px.comfortable,
    border: `1px solid ${ABYSS[100]}`,
  }}>
    <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
      <Bot size={20} color={DEEP_CURRENT[600]} />
      <span style={{ fontWeight: 600, color: ABYSS[700] }}>update-docs</span>
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[500], marginBottom: '12px' }}>
      Source: Multiple agent rule files
    </div>
    <div style={{ fontSize: '13px', color: ABYSS[600] }}>
      Generates:
      <ul style={{ margin: '8px 0 0 0', paddingLeft: '20px' }}>
        <li>Agent instruction aggregations</li>
        <li>Rule file indexes</li>
      </ul>
    </div>
  </div>
</div>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Validators (Stage 2)</h2>

<SectionHeader
  icon={<Shield size={20} />}
  title="Health Check Suite"
  description="These validators run in sequence. If any fails, the commit is blocked."
/>

<div style={{ marginBottom: SPACING.px.comfortable }}>
  <ValidatorGrid />
</div>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Validator Deep Dive</h2>

<SectionHeader
  icon={<FileCode size={20} />}
  title="What Each Validator Does"
  description="Comprehensive breakdown of validation logic, files checked, and how to fix failures."
/>

{/* validate:tokens - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${HARBOR[200]}`,
  marginBottom: SPACING.px.comfortable,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: HARBOR[700],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <Palette size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate:tokens</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>Token 3-File Drift Detection</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    DDS uses intentional manual sync between 3 token files. This validator detects when they drift out of sync.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>src/constants/designTokens.ts</code> (source of truth)<br/>
        <code>src/styles.css</code> (@theme block)<br/>
        <code>tailwind-preset.js</code> (NPM consumers)
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • All 9 palettes present in all files<br/>
        • Hex values match exactly (#XXXXXX)<br/>
        • RADIUS values synchronized<br/>
        • Semantic tokens (error, success, etc.)
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: CORAL[400] }}>✗ DEEP_CURRENT[500]: designTokens.ts has "#0891B2", tailwind-preset.js has "#0891B3"</div>
    <div style={{ color: ABYSS[400], marginTop: '4px' }}>  └─ tailwind-preset.js:47</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: HARBOR[700] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Update the drifted file to match designTokens.ts</span>
  </div>
</div>

{/* validate:readme - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${HARBOR[200]}`,
  marginBottom: SPACING.px.comfortable,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: HARBOR[700],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <FileText size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate:readme</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>README ↔ Package Exports Sync</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    Ensures consumers see accurate import paths in documentation. Checks that all package.json exports are documented in README.md.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>package.json</code> (exports field)<br/>
        <code>README.md</code> (documentation)
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • Each subpath export mentioned in README<br/>
        • @dds/design-system/core, /flow, /tokens<br/>
        • "Package Architecture" section exists<br/>
        • Import syntax is correct
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: SUNRISE[400] }}>⚠ /flow not documented in README</div>
    <div style={{ color: ABYSS[400], marginTop: '4px' }}>  Subpath "/flow" exists in package.json but not documented</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: HARBOR[700] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Add import example to README.md: <code>import {'{ ... }'} from '@dds/design-system/flow'</code></span>
  </div>
</div>

{/* validate-context - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${DUSK_REEF[200]}`,
  marginBottom: SPACING.px.comfortable,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: DUSK_REEF[600],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <Layers size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate-context</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>Agent Context JSON Integrity</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    The agent-context.json is the single source of truth for component registry. This validator ensures it stays in sync with actual files.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>.claude/agent-context.json</code><br/>
        <code>{`src/components/ui/*.tsx`}</code><br/>
        <code>tailwind-preset.js</code> (safelist)
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • Component paths exist on disk<br/>
        • Status values in statusLegend<br/>
        • testId values in testIdLegend<br/>
        • testIdProgress counts match actual<br/>
        • Color hex format valid (#XXXXXX)
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: CORAL[400] }}>✗ Button.status: "DRAFT" (expected: STABLE | STABILIZING | NEEDS_WORK)</div>
    <div style={{ color: SUNRISE[400], marginTop: '4px' }}>⚠ Button: file not found at ui/Button.tsx</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: DUSK_REEF[600] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Update agent-context.json or create the missing file</span>
  </div>
</div>

{/* validate:agents - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${DUSK_REEF[200]}`,
  marginBottom: SPACING.px.comfortable,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: DUSK_REEF[600],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <Bot size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate:agents</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>Agent Instruction Reality Check</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    PREVENTS AI CONFUSION. Validates that file paths and colors mentioned in agent instructions (.claude/{'*'}.md) actually exist in the codebase.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>{`.claude/agents/*.md`}</code><br/>
        <code>{`.claude/plugins/*/agents/*.md`}</code><br/>
        Cross-referenced against actual files
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • <code>{`src/*.tsx`}</code> paths exist<br/>
        • Hex colors (#XXXXXX) in designTokens<br/>
        • Skips code blocks (examples OK)<br/>
        • Skips glob patterns {'(*.tsx OK)'}
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: CORAL[400] }}>✗ component-dev-rules.md:47 - Referenced file does not exist: src/components/ui/OldButton.tsx</div>
    <div style={{ color: SUNRISE[400], marginTop: '4px' }}>⚠ color-matrix.md:12 - Unknown hex color #FF0000 - may be stale</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: DUSK_REEF[600] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Update the agent instruction file or restore the deleted file</span>
  </div>
</div>

{/* validate:version - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${CORAL[200]}`,
  marginBottom: SPACING.px.comfortable,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: CORAL[600],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <Package size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate:version</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>Semantic Version Drift Detection</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    Detects when a version bump is needed but hasn't been done. New components or exports require MINOR bump.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>package.json</code> (version)<br/>
        <code>.claude/changelog.json</code><br/>
        <code>src/index.ts</code> (exports)<br/>
        Git diff since last tag
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • package.json = changelog.json version<br/>
        • New component files → bump warning<br/>
        • Modified src/index.ts → bump warning<br/>
        • Missing exports detected
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: CORAL[400] }}>✗ [VERSION_MISMATCH] package.json (2.5.0) ≠ changelog.json (2.4.0)</div>
    <div style={{ color: SUNRISE[400], marginTop: '4px' }}>⚠ [NEW_COMPONENTS] 2 component file(s) modified but version not bumped</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: CORAL[600] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Run <code>npm run version:minor</code> or <code>npm run version:patch</code></span>
  </div>
</div>

{/* validate:prompts - DETAILED */}
<div style={{
  background: PRIMITIVES.white,
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  border: `2px solid ${CORAL[200]}`,
  marginBottom: SPACING.px.section,
}}>
  <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '16px' }}>
    <div style={{
      background: CORAL[600],
      padding: '8px',
      borderRadius: RADIUS.md,
      display: 'flex',
    }}>
      <BookOpen size={20} color={PRIMITIVES.white} />
    </div>
    <div>
      <div style={{ fontWeight: 700, color: ABYSS[700], fontSize: '16px' }}>validate:prompts</div>
      <div style={{ fontSize: '12px', color: ABYSS[400] }}>Prompt Template Path Validation</div>
    </div>
  </div>

  <div style={{ fontSize: '13px', color: ABYSS[600], marginBottom: '16px', lineHeight: 1.6 }}>
    Prevents prompt drift - ensures all file paths referenced in prompts.ts actually exist. No more "read this file" pointing to deleted files.
  </div>

  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '16px' }}>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>FILES CHECKED</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        <code>src/components/shared/PromptLibrary/prompts.ts</code><br/>
        Cross-references all paths mentioned
      </div>
    </div>
    <div>
      <div style={{ fontWeight: 600, color: ABYSS[700], fontSize: '12px', marginBottom: '8px' }}>WHAT IT VALIDATES</div>
      <div style={{ fontSize: '12px', color: ABYSS[500], lineHeight: 1.8 }}>
        • <code>{`.claude/*.md`}</code> files exist<br/>
        • <code>{`.claude/*.json`}</code> files exist<br/>
        • <code>src/</code> directory paths exist<br/>
        • Tries .ts and .tsx extensions
      </div>
    </div>
  </div>

  <div style={{
    background: ABYSS[800],
    borderRadius: RADIUS.md,
    padding: '12px',
    fontFamily: 'JetBrains Mono, monospace',
    fontSize: '11px',
    marginBottom: '12px',
  }}>
    <div style={{ color: CORAL[400] }}>✗ Missing: .claude/old-rules.md</div>
    <div style={{ color: CORAL[400] }}>✗ Missing: src/components/deprecated/OldComponent</div>
  </div>

  <div style={{ fontSize: '12px' }}>
    <span style={{ fontWeight: 600, color: CORAL[600] }}>FIX:</span>
    <span style={{ color: ABYSS[500] }}> Update prompts.ts to remove stale references, or restore the files</span>
  </div>
</div>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Command Reference</h2>

<div style={{
  background: ABYSS[800],
  borderRadius: RADIUS.lg,
  padding: SPACING.px.comfortable,
  fontFamily: 'JetBrains Mono, monospace',
  fontSize: '13px',
  lineHeight: 1.8,
  marginBottom: SPACING.px.section,
}}>
  <div style={{ color: ABYSS[400], marginBottom: '8px' }}># Run everything (pre-commit does this)</div>
  <div style={{ color: PRIMITIVES.white }}>npm run sync:all && npm run health</div>

  <div style={{ color: ABYSS[400], marginTop: '16px', marginBottom: '8px' }}># Individual sync scripts</div>
  <div style={{ color: DEEP_CURRENT[300] }}>npm run sync:prompts      <span style={{ color: ABYSS[500] }}># Generate skill files</span></div>
  <div style={{ color: DEEP_CURRENT[300] }}>npm run sync:colors       <span style={{ color: ABYSS[500] }}># Generate color matrices</span></div>
  <div style={{ color: DEEP_CURRENT[300] }}>npm run sync-docs         <span style={{ color: ABYSS[500] }}># Generate component status</span></div>
  <div style={{ color: DEEP_CURRENT[300] }}>npm run update-docs       <span style={{ color: ABYSS[500] }}># Update agent docs</span></div>

  <div style={{ color: ABYSS[400], marginTop: '16px', marginBottom: '8px' }}># Individual validators</div>
  <div style={{ color: HARBOR[300] }}>npm run validate:tokens   <span style={{ color: ABYSS[500] }}># 3-file token sync</span></div>
  <div style={{ color: HARBOR[300] }}>npm run validate:readme   <span style={{ color: ABYSS[500] }}># README ↔ exports</span></div>
  <div style={{ color: DUSK_REEF[300] }}>npm run validate-context  <span style={{ color: ABYSS[500] }}># agent-context.json</span></div>
  <div style={{ color: DUSK_REEF[300] }}>npm run validate:agents   <span style={{ color: ABYSS[500] }}># Agent instructions</span></div>
  <div style={{ color: CORAL[300] }}>npm run validate:version  <span style={{ color: ABYSS[500] }}># Version drift</span></div>
  <div style={{ color: CORAL[300] }}>npm run validate:prompts  <span style={{ color: ABYSS[500] }}># Prompt paths</span></div>

  <div style={{ color: ABYSS[400], marginTop: '16px', marginBottom: '8px' }}># Manual only</div>
  <div style={{ color: ABYSS[300] }}>npm run validate:contrast <span style={{ color: ABYSS[500] }}># WCAG contrast (slow)</span></div>
</div>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Failure Modes</h2>

<SectionHeader
  icon={<AlertTriangle size={20} />}
  title="What Happens When Validation Fails"
  description="Each validator provides actionable error messages."
/>

<div style={{
  display: 'grid',
  gridTemplateColumns: '1fr',
  gap: '12px',
  marginBottom: SPACING.px.section,
}}>
  <GuidelineCard
    icon={<XCircle size={18} color={CORAL[500]} />}
    title="Token Drift"
    correct="Update all 3 files (designTokens.ts, styles.css, tailwind-preset.js)"
    incorrect="Update only one file"
  />
  <GuidelineCard
    icon={<XCircle size={18} color={CORAL[500]} />}
    title="README Drift"
    correct="Update README.md with new export paths"
    incorrect="Add exports without documenting"
  />
  <GuidelineCard
    icon={<XCircle size={18} color={CORAL[500]} />}
    title="Agent Instruction Drift"
    correct={`Update .claude/agents/*.md or fix referenced paths`}
    incorrect="Leave stale file references in instructions"
  />
  <GuidelineCard
    icon={<XCircle size={18} color={CORAL[500]} />}
    title="Version Drift"
    correct="Run npm run version:minor (or patch/major)"
    incorrect="Add components without version bump"
  />
  <GuidelineCard
    icon={<XCircle size={18} color={CORAL[500]} />}
    title="Prompt Drift"
    correct="Update prompts.ts or restore deleted files"
    incorrect="Reference files that don't exist"
  />
</div>

<InfoBox variant="warning">
  <strong>All validators block commits.</strong> Fix the issue, then commit again.
  The error messages tell you exactly what to fix.
</InfoBox>
