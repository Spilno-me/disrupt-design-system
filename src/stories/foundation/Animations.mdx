{/* @jsxRuntime automatic */}
{/* @jsxImportSource react */}
import { Meta } from '@storybook/addon-docs/blocks';
import { Sparkles, Clock, Zap, Timer } from 'lucide-react';
import {
  BrandHero,
  InfoBox,
  PRIMITIVES,
  SPACING,
} from '../brand/BrandComponents';
import { CodeBlock } from './DocComponents';
import {
  ProductiveShortDemo,
  ProductiveMediumDemo,
  ProductiveLongDemo,
  ExpressiveShortDemo,
  ExpressiveLongDemo,
  EnterEasingDemo,
  ExitEasingDemo,
  TransitionEasingDemo,
  EmphasizeEasingDemo,
  DelayDemo,
  KeyframePopDemo,
  KeyframeSlideDemo,
  KeyframeAttentionDemo,
  ReducedMotionDemo,
} from './AnimationDemos';

<Meta title="Foundation/Design Tokens/Animations" />

<BrandHero
  title="Motion & Animation"
  description="A semantic motion token system inspired by Vibe Design System. Productive animations for functional feedback, Expressive animations for delightful emphasis."
  gradient="purple"
  decorativeIcon={<Sparkles size={180} color={PRIMITIVES.white} strokeWidth={1} />}
/>

<InfoBox variant="tip">
  <strong>Vibe-inspired approach:</strong> Motion tokens are categorized by intent, not just speed.
  <strong>Productive</strong> = functional, immediate. <strong>Expressive</strong> = delightful, emphasizing.
</InfoBox>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Duration Tokens</h2>

### Productive Durations (70ms - 150ms)

Quick, functional animations for user-initiated interactions. Use for micro-feedback that shouldn't delay the user.

<ProductiveShortDemo />

<ProductiveMediumDemo />

<ProductiveLongDemo />

### Expressive Durations (250ms - 400ms)

Deliberate, emphasizing animations for system-initiated content. Use for moments that deserve attention.

<ExpressiveShortDemo />

<ExpressiveLongDemo />

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Easing Curves</h2>

### Enter Easing

Elements appearing on screen - **fast start, slow end** (decelerate into place).

<EnterEasingDemo />

### Exit Easing

Elements leaving the screen - **slow start, fast end** (accelerate away).

<ExitEasingDemo />

### Transition Easing

On-screen state changes - **smooth both ways** (morphing in place).

<TransitionEasingDemo />

### Emphasize Easing

Attention-grabbing with **subtle overshoot** (bounce effect). Use sparingly!

<EmphasizeEasingDemo />

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Delay Tokens</h2>

### Staggered Animations

Create cascading effects that guide the eye naturally.

<DelayDemo />

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Usage in Code</h2>

### CSS Usage

<CodeBlock
  code={`/* Button hover - productive short */
.button {
  transition:
    background-color var(--motion-duration-productive-short) var(--motion-easing-transition),
    transform var(--motion-duration-productive-short) var(--motion-easing-transition);
}

/* Modal enter - expressive short with enter easing */
.modal-enter {
  animation: slideIn var(--motion-duration-expressive-short) var(--motion-easing-enter);
}

/* Modal exit - expressive short with exit easing */
.modal-exit {
  animation: slideOut var(--motion-duration-expressive-short) var(--motion-easing-exit);
}

/* Staggered list items */
.list-item:nth-child(1) { animation-delay: calc(var(--motion-delay-short) * 0); }
.list-item:nth-child(2) { animation-delay: calc(var(--motion-delay-short) * 1); }
.list-item:nth-child(3) { animation-delay: calc(var(--motion-delay-short) * 2); }`}
  language="css"
/>

### Framer Motion Usage

<CodeBlock
  code={`import { MOTION } from '@adrozdenko/design-system'

// Enter animation
const enterVariants = {
  hidden: { opacity: 0, y: 20 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.25, // expressiveShort in seconds
      ease: MOTION.easing.enterArray, // [0, 0, 0.35, 1]
    }
  }
}

// Exit animation
const exitVariants = {
  exit: {
    opacity: 0,
    y: -10,
    transition: {
      duration: 0.15, // productiveLong in seconds
      ease: MOTION.easing.exitArray, // [0.4, 0, 1, 1]
    }
  }
}

// Attention animation (emphasize)
const bounceVariants = {
  attention: {
    scale: [1, 1.05, 1],
    transition: {
      duration: 0.25,
      ease: MOTION.easing.emphasizeArray, // [0, 0, 0.2, 1.4]
    }
  }
}`}
  language="tsx"
/>

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Quick Reference</h2>

| Token | Value | Use Case |
|-------|-------|----------|
| `--motion-duration-productive-short` | 70ms | Hover states, micro-feedback |
| `--motion-duration-productive-medium` | 100ms | Toggles, checkboxes |
| `--motion-duration-productive-long` | 150ms | Tooltips, small reveals |
| `--motion-duration-expressive-short` | 250ms | Modals, cards, panels |
| `--motion-duration-expressive-long` | 400ms | Page transitions, heroes |
| `--motion-easing-enter` | cubic-bezier(0, 0, 0.35, 1) | Elements appearing |
| `--motion-easing-exit` | cubic-bezier(0.4, 0, 1, 1) | Elements leaving |
| `--motion-easing-transition` | cubic-bezier(0.4, 0, 0.2, 1) | State changes |
| `--motion-easing-emphasize` | cubic-bezier(0, 0, 0.2, 1.4) | Attention (use sparingly) |
| `--motion-delay-short` | 50ms | Quick stagger |
| `--motion-delay-normal` | 100ms | Standard delay |
| `--motion-delay-long` | 200ms | Pronounced stagger |

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Keyframe Animations</h2>

<InfoBox variant="tip">
  <strong>Absorbed from Vibe Design System:</strong> Pre-built keyframe animations for common UI patterns.
  Import from <code>@dds/design-system/styles/motion.css</code> or use the TypeScript constants from <code>MOTION_KEYFRAMES</code>.
</InfoBox>

### Pop Animations (Scale-based)

Use for modals, tooltips, popovers, cards - elements that appear "on top" of the UI.

<KeyframePopDemo />

| Keyframe | Effect | Duration | Use Case |
|----------|--------|----------|----------|
| `dds-pop-in` | Scale 0.8 → 1 with fade | 250ms | Standard modal/tooltip entry |
| `dds-pop-out` | Scale 1 → 0.8 with fade | 150ms | Modal/tooltip exit |
| `dds-pop-elastic` | Bouncy overshoot | 400ms | Playful, attention-grabbing |
| `dds-pop-elastic-bold` | More pronounced bounce | 500ms | High emphasis (use sparingly) |

### Slide Animations (Position-based)

Use for toasts, drawers, panels, notifications - elements that slide in from edges.

<KeyframeSlideDemo />

| Keyframe | Effect | Duration | Use Case |
|----------|--------|----------|----------|
| `dds-slide-in-up` | From bottom | 250ms | Toasts, bottom sheets |
| `dds-slide-in-down` | From top | 250ms | Dropdowns, notifications |
| `dds-slide-in-left` | From left | 250ms | Side panels, drawers |
| `dds-slide-in-right` | From right | 250ms | Side panels, drawers |
| `dds-slide-in-up-elastic` | Bouncy from bottom | 400ms | Playful toasts |

### Attention Animations (Emphasis)

Use sparingly for drawing user attention to important elements.

<KeyframeAttentionDemo />

| Keyframe | Effect | Use Case |
|----------|--------|----------|
| `dds-pulse` | Gentle scale pulse | New notifications, badges |
| `dds-shake` | Horizontal shake | Form errors, invalid input |
| `dds-bounce` | Vertical bounce | CTAs, important buttons |
| `dds-wiggle` | Subtle rotation | Playful attention |
| `dds-spin` | Continuous rotation | Loading indicators |
| `dds-spin-in` | Rotation + scale entry | Success checkmarks |

---

<h2 style={{ marginTop: SPACING.px.sectionHeadingTop, marginBottom: SPACING.px.sectionHeadingBottom }}>Accessibility</h2>

<InfoBox variant="warning">
  <strong>WCAG 2.1 Requirement:</strong> Always respect <code>prefers-reduced-motion</code> for users with vestibular disorders.
</InfoBox>

<ReducedMotionDemo />

### Reduced Motion Support

DDS includes automatic reduced motion support. When users have "Reduce motion" enabled in their OS settings, all animations are instantly completed:

<CodeBlock
  code={`/* Automatically included in motion.css */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}`}
  language="css"
/>

### Manual Reduced Motion Handling

For custom animations, check the preference programmatically:

<CodeBlock
  code={`// React hook for reduced motion
const prefersReducedMotion = window.matchMedia(
  '(prefers-reduced-motion: reduce)'
).matches;

// Framer Motion respects this automatically
<motion.div
  animate={{ opacity: 1, y: 0 }}
  transition={{
    duration: prefersReducedMotion ? 0 : 0.25,
    ease: MOTION.easing.enterArray,
  }}
/>`}
  language="tsx"
/>

### Animation Guidelines for Accessibility

| Do | Don't |
|----|-------|
| Keep animations under 5 seconds | Use infinite loops without user control |
| Provide pause/stop controls for long animations | Flash content more than 3 times per second |
| Use motion to enhance, not replace, information | Rely solely on motion to convey meaning |
| Test with reduced motion enabled | Assume all users can perceive motion |
